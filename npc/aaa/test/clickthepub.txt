icecastle,196,203,4	script	This Is A Cat	800,{

	// ===============================
	// GM เริ่มกิจกรรม
	// ===============================
	if (getgmlevel() >= 99) {
		if ($@status_event_active) {
			mes "[Event Staff]";
			mes "กิจกรรมกำลังดำเนินอยู่แล้ว.";
			close;
		}
		mes "[Event Staff]";
		mes "คุณต้องการเริ่มกิจกรรมหรือไม่?";
		if (select("เริ่มกิจกรรม:ยกเลิก") == 2) close;

		$@status_event_active = 1;
		$@status_event_winner$ = "";
		announce "[กิจกรรมสุ่มสถานะ] เริ่มแล้ว! มาที่ icecastle 196,203 แล้วกด NPC เพื่อชิงรางวัล!", bc_all;
		initnpctimer;
		close;
	}

	// ===============================
	// ผู้เล่นกด NPC ระหว่างกิจกรรม
	// ===============================
	if (!$@status_event_active) {
		mes "[กิจกรรม]";
		mes "กิจกรรมยังไม่เริ่ม หรือได้สิ้นสุดไปแล้ว.";
		close;
	}

	if ($@status_event_winner$ != "") {
		mes "[กิจกรรม]";
		mes "ผู้ชนะคือ " + $@status_event_winner$ + ".";
		close;
	}

	// สุ่มโอกาสชนะ
	if (rand(100) < 1) {
		$@status_event_winner$ = strcharinfo(0);
		mes "[กิจกรรม]";
		mes "คุณคือผู้ชนะ!!";
		announce "[กิจกรรมสุ่มสถานะ] ผู้ชนะคือ " + strcharinfo(0) + "!", bc_all;
		// สามารถให้รางวัลได้ที่นี่
		getitem 2001101, 1;
		$@status_event_active = 0;
		stopnpctimer;
		end;
	}

	// ถ้าไม่ชนะ โดนสถานะสุ่ม
	switch (rand(0, 8)) {
		case 0: sc_start SC_SLEEP, 5000, 0; break;
		case 1: sc_start SC_STONE, 5000, 0; break;
		case 2: sc_start SC_FREEZE, 5000, 0; break;
		case 3: sc_start SC_COMA, 5000, 0; break;
		case 4: percentheal -100, -100; break;
		case 1: sc_start SC_STONE, 5000, 0; break;
		case 2: sc_start SC_FREEZE, 5000, 0; break;
		case 3: sc_start SC_COMA, 5000, 0; break;
		case 4: sc_start SC_SLEEP, 5000, 0; break;
	}
	close;

OnTimer300000: // 5 นาที = 300,000 ms
	stopnpctimer;
	if ($@status_event_winner$ == "") {
		announce "[กิจกรรมสุ่มสถานะ] สิ้นสุดลงโดยไม่มีผู้ชนะ.", bc_all;
	}
	$@status_event_active = 0;
	$@status_event_winner$ = "";
	end;
}